



KEY_ID_TO_NAME_MAP = \
{1:'Lbutton',
2:'Rbutton',
3:'Cancel',
4:'Mbutton',
8:'Back',
9:'Tab',
12:'Clear',
13:'Return',
16:'Shift',
17:'Control',
18:'Menu',
19:'Pause',
20:'Capital',
21:'Hangul',
23:'Junja',
24:'Final',
25:'Hanja',
27:'Escape',
28:'Convert',
29:'Nonconvert',
30:'Accept',
31:'Modechange',
32:'Space',
33:'Prior',
34:'Next',
35:'End',
36:'Home',
37:'Left',
38:'Up',
39:'Right',
40:'Down',
41:'Select',
42:'Print',
43:'Execute',
44:'Snapshot',
45:'Insert',
46:'Delete',
47:'Help',
48:'0',
49:'1',
50:'2',
51:'3',
52:'4',
53:'5',
54:'6',
55:'7',
56:'8',
57:'9',
65:'A',
66:'B',
67:'C',
68:'D',
69:'E',
70:'F',
71:'G',
72:'H',
73:'I',
74:'J',
75:'K',
76:'L',
77:'M',
78:'N',
79:'O',
80:'P',
81:'Q',
82:'R',
83:'S',
84:'T',
85:'U',
86:'V',
87:'W',
88:'X',
89:'Y',
90:'Z',
91:'Lwin',
92:'Rwin',
93:'Apps',
96:'Numpad0',
97:'Numpad1',
98:'Numpad2',
99:'Numpad3',
100:'Numpad4',
101:'Numpad5',
102:'Numpad6',
103:'Numpad7',
104:'Numpad8',
105:'Numpad9',
106:'Multiply',
107:'Add',
108:'Separator',
109:'Subtract',
110:'Decimal',
111:'Divide',
112:'F1',
113:'F2',
114:'F3',
115:'F4',
116:'F5',
117:'F6',
118:'F7',
119:'F8',
120:'F9',
121:'F10',
122:'F11',
123:'F12',
124:'F13',
125:'F14',
126:'F15',
127:'F16',
128:'F17',
129:'F18',
130:'F19',
131:'F20',
132:'F21',
133:'F22',
134:'F23',
135:'F24',
144:'Numlock',
145:'Scroll',
160:'Lshift',
161:'Rshift',
162:'Lcontrol',
163:'Rcontrol',
164:'Lmenu',
165:'Rmenu',
166:'Browser_Back',
167:'Browser_Forward',
168:'Browser_Refresh',
169:'Browser_Stop',
170:'Browser_Search',
171:'Browser_Favorites',
172:'Browser_Home',
173:'Volume_Mute',
174:'Volume_Down',
175:'Volume_Up',
176:'Media_Next_Track',
177:'Media_Prev_Track',
178:'Media_Stop',
179:'Media_Play_Pause',
180:'Launch_Mail',
181:'Launch_Media_Select',
182:'Launch_App1',
183:'Launch_App2',
186:'Oem_1',
187:'Oem_Plus',
188:'Oem_Comma',
189:'Oem_Minus',
190:'Oem_Period',
191:'Oem_2',
192:'Oem_3',
219:'Oem_4',
220:'Oem_5',
221:'Oem_6',
222:'Oem_7',
223:'Oem_8',
226:'Oem_102',
229:'Processkey',
231:'Packet',
246:'Attn',
247:'Crsel',
248:'Exsel',
249:'Ereof',
250:'Play',
251:'Zoom',
252:'Noname',
253:'Pa1',
254:'Oem_Clear'}



NAME_OVERRIDE_LIST = {
    "lmenu":"menu",
    "lcontrol":"control",
    "lshift":"shift",
    "lwin":"win",
    "rmenu":"menu",
    "rcontrol":"control",
    "rshift":"shift",
    "rwin":"win"
}

JAVA_KEY_CODES = {
    10:"Enter",
    8:"Backspace",
    9:"Tab",
    16:"Shift",
    17:"Control",
    18:"Alt",
    157:"Meta",
    524:"Windows",
    525:"Context Menu",
    19:"Pause",
    20:"Caps Lock",
    27:"Escape",
    32:"Space",
    38:"Up",
    40:"Down",
    37:"Left",
    39:"Right",
    44:"Comma",
    45:"Minus",
    46:"Period",
    47:"Slash",
    61:"Equals",
    59:"Semicolon",
    91:"Open Bracket",
    92:"Back Slash",
    93:"Close Bracket",
    224:"Up",
    225:"Down",
    226:"Left",
    227:"Right",
    106:"NumPad *",
    107:"NumPad +",
    109:"NumPad -",
    110:"NumPad .",
    111:"NumPad /",
    127:"Delete",
    144:"Num Lock",
    3:"Clear",
    145:"Scroll Lock",
    112:"F1",
    113:"F2",
    114:"F3",
    115:"F4",
    116:"F5",
    117:"F6",
    118:"F7",
    119:"F8",
    120:"F9",
    121:"F10",
    122:"F11",
    123:"F12",
    61440:"F13",
    61441:"F14",
    61442:"F15",
    61443:"F16",
    61444:"F17",
    61445:"F18",
    61446:"F19",
    61447:"F20",
    61448:"F21",
    61449:"F22",
    61450:"F23",
    61451:"F24",
    154:"Print Screen",
    155:"Insert",
    156:"Help",
    33:"Page Up",
    34:"Page Down",
    36:"Home",
    35:"End",
    222:"Quote",
    192:"Back Quote",
    128:"Dead Grave",
    129:"Dead Acute",
    130:"Dead Circumflex",
    131:"Dead Tilde",
    132:"Dead Macron",
    133:"Dead Breve",
    134:"Dead Above Dot",
    135:"Dead Diaeresis",
    136:"Dead Above Ring",
    137:"Dead Double Acute",
    138:"Dead Caron",
    139:"Dead Cedilla",
    140:"Dead Ogonek",
    141:"Dead Iota",
    142:"Dead Voiced Sound",
    143:"Dead Semivoiced Sound",
    150:"Ampersand",
    151:"Asterisk",
    152:"Double Quote",
    153:"Less",
    160:"Greater",
    161:"Left Brace",
    162:"Right Brace",
    512:"At",
    513:"Colon",
    514:"Circumflex",
    515:"Dollar",
    516:"Euro",
    517:"Exclamation Mark",
    518:"Inverted Exclamation Mark",
    519:"Left Parenthesis",
    520:"Number Sign",
    521:"Plus",
    522:"Right Parenthesis",
    523:"Underscore",
    24:"Quote",
    28:"Convert",
    29:"No Convert",
    30:"Accept",
    31:"Mode Change",
    21:"Kana",
    25:"Kanji",
    240:"Alphanumeric",
    241:"Katakana",
    242:"Hiragana",
    243:"Full-Width",
    244:"Half-Width",
    245:"Roman Characters",
    256:"All Candidates",
    257:"Previous Candidate",
    258:"Code Input",
    259:"Japanese Katakana",
    260:"Japanese Hiragana",
    261:"Japanese Roman",
    262:"Kana Lock",
    263:"Input Method On/Off",
    65481:"Again",
    65483:"Undo",
    65485:"Copy",
    65487:"Paste",
    65489:"Cut",
    65488:"Find",
    65482:"Props",
    65480:"Stop",
    65368:"Begin",
    0:"Undefined"
}



name_to_code_map = {
    "numpad 8":104,
    "numpad 9":105,
    "multiply":106,
    "add":107,
    "subtract":109,
    "decimal point":110,
    "divide":111,
    "f1":112,
    "f2":113,
    "f3":114,
    "f4":115,
    "f5":116,
    "f6":117,
    "f7":118,
    "f8":119,
    "f9":120,
    "f10":121,
    "f11":122,
    "f12":123,
    "num lock":144,
    "scroll lock":145,
    "semicolon":186,
    "equals":187,
    "comma":188,
    "dash":189,
    "period":190,
    "forward slash":191,
    "grave accent":192,
    "open bracket":219,
    "back slash":220,
    "close braket":221,
    "single quote":222,
    "e":69,
    "f":70,
    "g":71,
    "h":72,
    "i":73,
    "j":74,
    "k":75,
    "l":76,
    "m":77,
    "n":78,
    "o":79,
    "p":80,
    "q":81,
    "r":82,
    "s":83,
    "t":84,
    "u":85,
    "v":86,
    "w":87,
    "x":88,
    "y":89,
    "z":90,
    "left window key":91,
    "right window key":92,
    "select key":93,
    "numpad 0":96,
    "numpad 1":97,
    "numpad 2":98,
    "numpad 3":99,
    "numpad 4":100,
    "numpad 5":101,
    "numpad 6":102,
    "numpad 7":103,
    "backspace":8,
    "tab":9,
    "enter":13,
    "shift":16,
    "ctrl":17,
    "alt":18,
    "pause/break":19,
    "caps lock":20,
    "escape":27,
    "page up":33,
    "page down":34,
    "end":35,
    "home":36,
    "left arrow":37,
    "up arrow":38,
    "right arrow":39,
    "down arrow":40,
    "insert":45,
    "delete":46,
    "0":48,
    "1":49,
    "2":50,
    "3":51,
    "4":52,
    "5":53,
    "6":54,
    "7":55,
    "8":56,
    "9":57,
    "a":65,
    "b":66,
    "c":67,
    "d":68
}

JAVA_KEY_NAMES = {
    "enter":10,
    "backspace":8,
    "tab":9,
    "shift":16,
    "control":17,
    "alt":18,
    "meta":157,
    "windows":524,
    "context menu":525,
    "pause":19,
    "caps lock":20,
    "escape":27,
    "space":32,
    "up":38,
    "down":40,
    "left":37,
    "right":39,
    "comma":44,
    "minus":45,
    "period":46,
    "slash":47,
    "equals":61,
    "semicolon":59,
    "open bracket":91,
    "back slash":92,
    "close bracket":93,
    # "up":224,
    # "down":225,
    # "left":226,
    # "right":227,
    "numpad *":106,
    "numpad +":107,
    "numpad -":109,
    "numpad .":110,
    "numpad /":111,
    "delete":127,
    "num lock":144,
    "clear":3,
    "scroll lock":145,
    "f1":112,
    "f2":113,
    "f3":114,
    "f4":115,
    "f5":116,
    "f6":117,
    "f7":118,
    "f8":119,
    "f9":120,
    "f10":121,
    "f11":122,
    "f12":123,
    "f13":61440,
    "f14":61441,
    "f15":61442,
    "f16":61443,
    "f17":61444,
    "f18":61445,
    "f19":61446,
    "f20":61447,
    "f21":61448,
    "f22":61449,
    "f23":61450,
    "f24":61451,
    "print screen":154,
    "insert":155,
    "help":156,
    "page up":33,
    "page down":34,
    "home":36,
    "end":35,
    # "quote":222,
    "back quote":192,
    "dead grave":128,
    "dead acute":129,
    "dead circumflex":130,
    "dead tilde":131,
    "dead macron":132,
    "dead breve":133,
    "dead above dot":134,
    "dead diaeresis":135,
    "dead above ring":136,
    "dead double acute":137,
    "dead caron":138,
    "dead cedilla":139,
    "dead ogonek":140,
    "dead iota":141,
    "dead voiced sound":142,
    "dead semivoiced sound":143,
    "ampersand":150,
    "asterisk":151,
    "double quote":152,
    "less":153,
    "greater":160,
    "left brace":161,
    "right brace":162,
    "at":512,
    "colon":513,
    "circumflex":514,
    "dollar":515,
    "euro":516,
    "exclamation mark":517,
    "inverted exclamation mark":518,
    "left parenthesis":519,
    "number sign":520,
    "plus":521,
    "right parenthesis":522,
    "underscore":523,
    "quote":24,
    "convert":28,
    "no convert":29,
    "accept":30,
    "mode change":31,
    "kana":21,
    "kanji":25,
    "alphanumeric":240,
    "katakana":241,
    "hiragana":242,
    "full-width":243,
    "half-width":244,
    "roman characters":245,
    "all candidates":256,
    "previous candidate":257,
    "code input":258,
    "japanese katakana":259,
    "japanese hiragana":260,
    "japanese roman":261,
    "kana lock":262,
    "input method on/off":263,
    "again":65481,
    "undo":65483,
    "copy":65485,
    "paste":65487,
    "cut":65489,
    "find":65488,
    "props":65482,
    "stop":65480,
    "begin":65368,
    "undefined":0
}



def convertJavaKeyIDToRegularKeyID(java_key_id):
    java_to_regular = {
        44: 188,  # comma -> Snapshot
        155: 45,  # minus -> insert
        45: 189,  # insert -> minus
        92: 220,  # back slash -> Rwin
        91: 219,  # open bracket -> Lwin
        93: 221,  # ??? -> close bracket
        61: 187,  # equals ->
        46: 190,  # period -> Delete
        59: 186,  # semicolon ->
        127: 46,  # delete -> F16
        10: 13,  # enter ->
        129:191 # F16 -> /
    }

    if java_key_id in java_to_regular:
        return java_to_regular[java_key_id]
    else:
        return java_key_id